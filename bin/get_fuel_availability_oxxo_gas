#!/bin/bash

curl -sS -X POST -H "Content-Type:application/x-www-form-urlencoded" -H "Accept:application/json" -H "Ocp-Apim-Subscription-Key:4b6f2b0747f54e40853ab58ff3cbd6f8" -d "aba_estado=Jalisco" -d "aba_tar=${1:-Zapopan}" 'https://ogapi-mgmt.azure-api.net/gaxtank/est/aba/estaciones' | jq '{ items: [ .data[] | { marca: "OXXO GAS", direccion: .aba_domicilio, latitud: .aba_latitud, longitud: .aba_longitud, magna: (if .aba_ico_magna == "V" then true else (if .aba_ico_magna == "R" then false else null end) end), premium: (if .aba_ico_premium == "V" then true else (if .aba_ico_premium == "R" then false else null end) end), diesel: (if .aba_ico_diesel == "V" then true else (if .aba_ico_diesel == "R" then false else null end) end) } | select( .magna == true or .premium == true or .diesel == true ) ] }'
